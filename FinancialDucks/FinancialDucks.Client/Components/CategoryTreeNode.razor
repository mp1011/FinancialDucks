@using FinancialDucks.Application.Models
@using static FinancialDucks.Application.Features.CategoriesFeature

<li>
    <p @onclick="()=> CategorySelected.InvokeAsync(Category)">@Category.Name
        @if (!NumTransactions.HasValue)
        {
            <span class="badge bg-secondary">...</span> 
            <span class="badge bg-secondary">...</span>
        }
        else
        {
            <span class="badge bg-secondary">@NumTransactions</span> 
            <span class="badge bg-secondary">@DollarTotal.Value.ToString("C")</span>
        }
    </p> 
    <ul>
        @foreach(var child in Category.Children)
        {
            <li>
                <CategoryTreeNode Category=child NewButtonClick=@NewButtonClick CategorySelected=@CategorySelected/>
            </li>                    
        }          
        <li>
            <div class="input-group mb-3">
              <input @bind=NewCategoryText type="text" class="form-control" aria-label="New Category Name">
              <div class="input-group-append">
                <button type="button" class="btn btn-primary"
                    @onclick="() => NewButtonClick.InvokeAsync(new AddCategoryCommand(Category, NewCategoryText))">+</button>
              </div>
            </div>   
        </li>
    </ul>      
    
</li>